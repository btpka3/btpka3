

link:https://github.com/dolthub/dolt[dolt]



[source,shell]
----
# MacOs 上安装
brew install dolt

# 启动数据库
dolt sql-server
# 连接到数据库
dolt -u root -p "" sql
----

[source,shell]
----
mysql> \help
# 创建数据库
mysql> create database getting_started;
# 切换到数据库
mysql> use getting_started;


mysql> \status

# 创建表
mysql> create table employees (
    id int,
    last_name varchar(255),
    first_name varchar(255),
    primary key(id));
mysql> create table teams (
    id int,
    team_name varchar(255),
    primary key(id));
mysql> create table employees_teams(
    team_id int,
    employee_id int,
    primary key(team_id, employee_id),
    foreign key (team_id) references teams(id),
    foreign key (employee_id) references employees(id));

mysql> show tables;


mysql> call dolt_add('teams', 'employees', 'employees_teams');
mysql> call dolt_commit('-m', 'Created initial schema');
mysql> select * from dolt_log;


# 插入数据

mysql> insert into employees values
    (0, 'Sehn', 'Tim'),
    (1, 'Hendriks', 'Brian'),
    (2, 'Son','Aaron'),
    (3, 'Fitzgerald', 'Brian');
mysql> insert into teams values
    (0, 'Engineering'),
    (1, 'Sales');
mysql> insert into employees_teams(employee_id, team_id) values
    (0,0),
    (1,0),
    (2,0),
    (0,1),
    (3,1);

mysql> select * from dolt_status;
mysql> \status
mysql> select * from dolt_diff_employees;

mysql> call dolt_commit('-am', 'Populated tables with data');
mysql> select * from dolt_log;
mysql> select * from dolt_diff;

# 演示撤销修改
# 1. 错误示例：误删除了一个表
mysql> drop table employees_teams;
mysql> show tables;
# 2.  撤销
mysql> call dolt_reset('--hard');
mysql> show tables;
----
