

[source,shell]
----

# 基本用法
find <起始目录> <表达式>

----




== 表达式


[source,shell]
----
# 按文件名搜索（区分大小写）
find . -name "*.log"
# 按文件名搜索（不区分大小写）
find . -iname "*.log"


# 按路径搜索: 模式匹配
find . -path "*/log/*.log"
# 按路径搜索: 正则匹配
find . -regex ".*\.\(jpg\|png\)$"

# 按文件类型搜索.
# f : 普通文件
# d : 目录
# l：符号链接
# s：套接字
# b：块设备
# c：字符设备
# p：命名管道
find . -type f     # 查找所有文件类型的

# 按文件大小搜索
# -size <+/->n[单位]
# 单位: c-字节, k-KB, M-MB, G-GB
find . -size +100M  # 大于 100M的
find . -size -100M  # 小于 100M的

# 按时间搜索
find . -mtime -7    # 按修改时间（天级别）：7天内修改的文件
find . -mtime +7    # 按修改时间（天级别）：7天前修改的文件
find . -atime -7    # 按访问时间（天级别）：7天内访问的文件
find . -atime +7    # 按访问时间（天级别）：7天前访问的文件
find . -ctime -7    # 按状态变更时间（天级别）：7天内状态变更的
find . -ctime +7    # 按状态变更时间（天级别）：7天前状态变更的
find . -mmin  -7    # 按修改时间（分钟级）：7分钟内修改的文件
find . -mmin  +7    # 按修改时间（分钟级）：7分钟前修改的文件

# 按权限搜索
find . -perm 644    # 权限为644的文件
find . -user admin  # 用户 admin 所有的
find . -group admin # 用户组 admin 所有的

# 深度空值
find . -maxdepth 1  # 设置最小深度
find . -maxdepth 3  # 设置最大深度


# 逻辑组合
# -and, -a  # 与（默认）
# -or, -o   # 或
# -not, !   # 非
# ()        # 分组（需转义）


----

== 动作

[source,shell]
----


-print                      # 默认动作，打印完整路径
-print0                     # 用NULL分隔结果（适合处理含空格文件名）
-exec xxx-command {} \;     # 对每个文件执行给定命令， {} 会呗替换为文件路径
-exec command {} +          # 一次传递多个文件
-ok                         # 交互式确认后执行
-delete                     # 直接删除文件
-ls                         # 显示详细文件信息

# 找到包含给定文本的日志文件
find $(pwd) -type f -name "*.log" -exec grep -rnwH -F "tomcat/bin/tomcat-juli.jar" {} \;

sudo find  /  -type f -name "*.log" -exec grep -rnwH -F "/usr/bin/curl http://33.40.87.131:7001/shutdown.htm" {} \;

----




== 示例

[source,shell]
----

# 排除目录
find / \( -path "/proc" -o -path "/sys" \) -prune -o -print


# 压缩所有日志文件。
find /var/log -name "*.log" -exec gzip {} +  # 压缩所有日志


# 找到包含给定文本的日志文件
find $(pwd) -type f -name "*.log" -exec grep -rnwH -F "tomcat/bin/tomcat-juli.jar" {} \;

sudo find  / \( -path "/proc" -o -path "/sys" \) -prune -type f -name "*.log" -exec grep -rnwH -F "/usr/bin/curl http://33.40.87.131:7001/shutdown.htm" {} \;



sudo find  /   -type f -name "*.log" -exec grep -rnwH -F "/usr/bin/curl http://33.40.87.131:7001/shutdown.htm" {} \;




----



=== 排除某些文件名

[source,shell]
----
cd ~
rm -fr /tmp/demo-find
mkdir -p /tmp/demo-find/{a,b,c}
cd /tmp/demo-find

cat > a/a.txt <<EOF
a11 hello a12
a21 hello a22
EOF

cat > b/b.log <<EOF
b11 hello b12
b21 hello b22
EOF

cat > c/c.plain <<EOF
c11 hello c12
c21 hello c22
EOF

# 排除文件 *.log
find .  -type f ! -path "*.log"
# 排除目录 a
find .  -type f ! -path "*/a/*"

----
