

link:https://wiki.openjdk.org/display/zgc/Main[ZGC]

link:https://docs.oracle.com/en/java/javase/21/gctuning/z-garbage-collector.html#[9 The Z Garbage Collector]

ä¼˜ç‚¹

- ä½å»¶è¿Ÿï¼Œåœé¡¿æ—¶é—´ä¸è¶…è¿‡ 10ms(STW)
- å¯ç”¨äºå¤§å †å†…å­˜ï¼ˆTBçº§åˆ«ï¼‰

ç¼ºç‚¹

- CPUæ¶ˆè€—é«˜: å®ç°è¾ƒä¸ºå¤æ‚ï¼ŒæŸäº›æƒ…å½¢ä¼šå¢åŠ CPUä½¿ç”¨ç‡ã€‚é«˜è´Ÿè½½é«˜å¹¶å‘åœºæ™¯å¯èƒ½ä¼šä¸å¤Ÿé«˜æ•ˆï¼Œ ç³Ÿç³•æ—¶ä¼šå°†å®š15%ååã€‚


[source,shell]
----

# é€šç”¨GCå‚æ•°
-Xms5g
-Xmx5g
-XX:SoftMaxHeapSize=4g          #

-XX:ConcGCThreads
-XX:ParallelGCThreads
-XX:+UseLargePages              # ä½¿ç”¨å¤§pageï¼ˆ2MBï¼‰ï¼Œ
-XX:+UseTransparentHugePages    # å¯ä»¥ä¸ç”¨æ‰‹åŠ¨å»è°ƒæ•´linux kernal å‚æ•°ï¼Œè‡ªåŠ¨å¯ç”¨ï¼Œä½†ä¸æ¨èã€‚
-XX:UseNUMA
-XX:SoftRefLRUPolicyMSPerMB
-XX:AllocateHeapAt


# ZGC å‚æ•°
# -XX:+UnlockExperimental

-XX:+UseZGC                     # ğŸ‘ğŸ» ä½¿ç”¨ZGC
-XX:+ZGenerational              # ğŸ‘ğŸ» ä½¿ç”¨åˆ†ä»£ZGC  æœªæ¥ä¼šå°†åˆ†ä»£ZGCè®¾ç½®ä¸ºé»˜è®¤å€¼

-XX:ZAllocationSpikeTolerance
-XX:ZCollectionInterval
-XX:ZFragmentationLimit
-XX:ZMarkStackSpaceLimit
-XX:ZProactive

-XX:-ZUncommit                  # ğŸ‘ğŸ» ç¦æ­¢å°†æœªä½¿ç”¨çš„å†…å­˜å½’è¿˜ç»™æ“ä½œç³»ç»Ÿ
-XX:ZUncommitDelay=<seconds>    # é»˜è®¤300ç§’ï¼Œ å¯ä»¥è®¾ç½®ä¸€ä¸ªåˆå§‹åŒ–ï¼Œè¿è¡Œåä¼šè‡ªåŠ¨è°ƒæ•´

# ZGCè¯Šæ–­å¼€å…³ éœ€è¦å…ˆå¼€å¯ `-XX:+UnlockDignosticVMOptions`
+XX:ZStaticsInterval
+XX:ZverifyForwarding
+XX:ZverifyMarking
+XX:ZverifyObjects
+XX:ZverifyRoots
+XX:ZverifyViews

# ???
-XX:ShenandoahUncommitDelay=<milliseconds>  #

----
